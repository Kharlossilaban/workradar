import '../models/holiday.dart';

/// Indonesian National Holidays Database
/// Data for 2026 and 2027 (Tanggal Merah)
class IndonesianHolidays {
  static final List<Holiday> _holidays2026 = [
    // 2026 National Holidays
    Holiday(
      id: 'nat_2026_01',
      name: 'Tahun Baru 2026',
      date: DateTime(2026, 1, 1),
      isNational: true,
      description: 'Tahun Baru Masehi',
    ),
    Holiday(
      id: 'nat_2026_02',
      name: 'Tahun Baru Imlek 2577',
      date: DateTime(2026, 2, 17),
      isNational: true,
      description: 'Tahun Baru Imlek',
    ),
    Holiday(
      id: 'nat_2026_03',
      name: 'Isra Mi\'raj Nabi Muhammad SAW',
      date: DateTime(2026, 3, 11),
      isNational: true,
    ),
    Holiday(
      id: 'nat_2026_04',
      name: 'Hari Raya Nyepi (Tahun Baru Saka 1948)',
      date: DateTime(2026, 3, 22),
      isNational: true,
      description: 'Hari Raya Nyepi',
    ),
    Holiday(
      id: 'nat_2026_05',
      name: 'Wafat Isa Al Masih',
      date: DateTime(2026, 4, 3),
      isNational: true,
      description: 'Jumat Agung',
    ),
    Holiday(
      id: 'nat_2026_06',
      name: 'Hari Raya Idul Fitri 1447 H',
      date: DateTime(2026, 3, 31),
      isNational: true,
      description: 'Idul Fitri Hari Pertama',
    ),
    Holiday(
      id: 'nat_2026_07',
      name: 'Hari Raya Idul Fitri 1447 H',
      date: DateTime(2026, 4, 1),
      isNational: true,
      description: 'Idul Fitri Hari Kedua',
    ),
    Holiday(
      id: 'nat_2026_08',
      name: 'Hari Buruh Internasional',
      date: DateTime(2026, 5, 1),
      isNational: true,
      description: 'May Day',
    ),
    Holiday(
      id: 'nat_2026_09',
      name: 'Kenaikan Isa Al Masih',
      date: DateTime(2026, 5, 14),
      isNational: true,
      description: 'Ascension Day',
    ),
    Holiday(
      id: 'nat_2026_10',
      name: 'Hari Raya Waisak 2570',
      date: DateTime(2026, 5, 31),
      isNational: true,
    ),
    Holiday(
      id: 'nat_2026_11',
      name: 'Hari Lahir Pancasila',
      date: DateTime(2026, 6, 1),
      isNational: true,
    ),
    Holiday(
      id: 'nat_2026_12',
      name: 'Hari Raya Idul Adha 1447 H',
      date: DateTime(2026, 6, 7),
      isNational: true,
      description: 'Idul Adha',
    ),
    Holiday(
      id: 'nat_2026_13',
      name: 'Tahun Baru Islam 1448 H',
      date: DateTime(2026, 6, 27),
      isNational: true,
      description: '1 Muharram',
    ),
    Holiday(
      id: 'nat_2026_14',
      name: 'Hari Kemerdekaan RI',
      date: DateTime(2026, 8, 17),
      isNational: true,
      description: 'Hari Proklamasi Kemerdekaan',
    ),
    Holiday(
      id: 'nat_2026_15',
      name: 'Maulid Nabi Muhammad SAW',
      date: DateTime(2026, 9, 5),
      isNational: true,
    ),
    Holiday(
      id: 'nat_2026_16',
      name: 'Hari Raya Natal',
      date: DateTime(2026, 12, 25),
      isNational: true,
      description: 'Christmas Day',
    ),
  ];

  static final List<Holiday> _holidays2027 = [
    // 2027 National Holidays
    Holiday(
      id: 'nat_2027_01',
      name: 'Tahun Baru 2027',
      date: DateTime(2027, 1, 1),
      isNational: true,
      description: 'Tahun Baru Masehi',
    ),
    Holiday(
      id: 'nat_2027_02',
      name: 'Tahun Baru Imlek 2578',
      date: DateTime(2027, 2, 6),
      isNational: true,
      description: 'Tahun Baru Imlek',
    ),
    Holiday(
      id: 'nat_2027_03',
      name: 'Isra Mi\'raj Nabi Muhammad SAW',
      date: DateTime(2027, 2, 28),
      isNational: true,
    ),
    Holiday(
      id: 'nat_2027_04',
      name: 'Hari Raya Nyepi (Tahun Baru Saka 1949)',
      date: DateTime(2027, 3, 11),
      isNational: true,
      description: 'Hari Raya Nyepi',
    ),
    Holiday(
      id: 'nat_2027_05',
      name: 'Hari Raya Idul Fitri 1448 H',
      date: DateTime(2027, 3, 20),
      isNational: true,
      description: 'Idul Fitri Hari Pertama',
    ),
    Holiday(
      id: 'nat_2027_06',
      name: 'Hari Raya Idul Fitri 1448 H',
      date: DateTime(2027, 3, 21),
      isNational: true,
      description: 'Idul Fitri Hari Kedua',
    ),
    Holiday(
      id: 'nat_2027_07',
      name: 'Wafat Isa Al Masih',
      date: DateTime(2027, 3, 26),
      isNational: true,
      description: 'Jumat Agung',
    ),
    Holiday(
      id: 'nat_2027_08',
      name: 'Hari Buruh Internasional',
      date: DateTime(2027, 5, 1),
      isNational: true,
      description: 'May Day',
    ),
    Holiday(
      id: 'nat_2027_09',
      name: 'Kenaikan Isa Al Masih',
      date: DateTime(2027, 5, 6),
      isNational: true,
      description: 'Ascension Day',
    ),
    Holiday(
      id: 'nat_2027_10',
      name: 'Hari Raya Waisak 2571',
      date: DateTime(2027, 5, 20),
      isNational: true,
    ),
    Holiday(
      id: 'nat_2027_11',
      name: 'Hari Raya Idul Adha 1448 H',
      date: DateTime(2027, 5, 27),
      isNational: true,
      description: 'Idul Adha',
    ),
    Holiday(
      id: 'nat_2027_12',
      name: 'Hari Lahir Pancasila',
      date: DateTime(2027, 6, 1),
      isNational: true,
    ),
    Holiday(
      id: 'nat_2027_13',
      name: 'Tahun Baru Islam 1449 H',
      date: DateTime(2027, 6, 17),
      isNational: true,
      description: '1 Muharram',
    ),
    Holiday(
      id: 'nat_2027_14',
      name: 'Hari Kemerdekaan RI',
      date: DateTime(2027, 8, 17),
      isNational: true,
      description: 'Hari Proklamasi Kemerdekaan',
    ),
    Holiday(
      id: 'nat_2027_15',
      name: 'Maulid Nabi Muhammad SAW',
      date: DateTime(2027, 8, 25),
      isNational: true,
    ),
    Holiday(
      id: 'nat_2027_16',
      name: 'Hari Raya Natal',
      date: DateTime(2027, 12, 25),
      isNational: true,
      description: 'Christmas Day',
    ),
  ];

  /// Get all national holidays for a specific year
  static List<Holiday> getHolidaysForYear(int year) {
    switch (year) {
      case 2026:
        return List.unmodifiable(_holidays2026);
      case 2027:
        return List.unmodifiable(_holidays2027);
      default:
        return [];
    }
  }

  /// Get all national holidays for a date range
  static List<Holiday> getHolidaysInRange(DateTime start, DateTime end) {
    final allHolidays = <Holiday>[];

    for (int year = start.year; year <= end.year; year++) {
      allHolidays.addAll(getHolidaysForYear(year));
    }

    return allHolidays.where((holiday) {
      return !holiday.date.isBefore(start) && !holiday.date.isAfter(end);
    }).toList();
  }

  /// Check if a date is a national holiday
  static bool isNationalHoliday(DateTime date) {
    final holidays = getHolidaysForYear(date.year);
    return holidays.any(
      (holiday) =>
          holiday.date.year == date.year &&
          holiday.date.month == date.month &&
          holiday.date.day == date.day,
    );
  }

  /// Get holiday for a specific date
  static Holiday? getHolidayForDate(DateTime date) {
    final holidays = getHolidaysForYear(date.year);
    try {
      return holidays.firstWhere(
        (holiday) =>
            holiday.date.year == date.year &&
            holiday.date.month == date.month &&
            holiday.date.day == date.day,
      );
    } catch (e) {
      return null;
    }
  }
}
